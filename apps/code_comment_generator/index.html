<html>
<head>
	<link rel="icon" href="https://image.flaticon.com/icons/png/128/2190/2190552.png">

	<title>Gerador de Comentário</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

	<style>
		.header {
			display: flex;
			flex-direction: row;
			margin: 30px 0;
		}

		.icon {
			width: 40px;
			height: 40px;
			margin-right: 20px;
		}

		.form {
			display: flex;
			flex-direction: row;
		}

		.input-container {
			max-width: 250px;
			margin-right: 20px;
		}

		.text-area {
			max-width: 100% !important;
			min-height: 150px !important;
			font-family: "Courier New";
			font-size: 12px;
		}

		.btn {
			width: 100%;
		}

		.last-item {
			margin-bottom: 100px;
		}
	</style>
</head>

<body>
	<div class="container">
		<div class="header">
			<!-- <img class="icon" src="https://img.icons8.com/cotton/2x/comments--v2.png"> -->
			<img class="icon" src="https://image.flaticon.com/icons/png/128/2190/2190552.png">
			<h2>Gerador de Comentários</h2>
		</div>

		<div class="form">
			<div class="input-grupo flex-nowrap mb-3 input-container">
				<input type="text" id="autor" class="form-control" placeholder="Nome" />		
			</div>

			<div class="input-grupo flex-nowrap mb-3 input-container">
				<input type="date" id="data" class="form-control" placeholder="Data" />
			</div>

			<div class="input-grupo flex-nowrap mb-3 input-container">
				<input type="text" id="usd" class="form-control" placeholder="USD" />
			</div>				
		</div>		
		
		<div class="input-grupo mb-3">
			<textarea class="form-control text-area" id="descricao" placeholder="Descrição"></textarea>
		</div>

		<div class="input-grupo mb-3">
			<button type="button" onClick="GeraComentario()" class="btn btn-primary">Gerar Comentário</button>
		</div>

		<div class="input-grupo last-item">
			<textarea class="form-control text-area" id="resultado" placeholder="Seu Comentário"></textarea>
		</div>
	</div>		
</body>

<script>
	/* Editaveis */
	var maxLength = 100
	var lineStart = 13
	var separator = "*"

	/* Fixos */
	var maxDescription = (maxLength - lineStart)		

	var data = new Date()		

	function GeraComentario() {		
		var autor = " Autor     : " + document.getElementById('autor').value			
		var descricao = document.getElementById('descricao').value 
		descricao = " Descrição : " + SepararDescricao(descricao)
		var dataObj = new Date(document.getElementById('data').value)
		var usd = " USD       : " + document.getElementById('usd').value
		var base = "" +
"/*"+ separator.repeat(maxLength) +"*/ \n" +
"/*:autor*/ \n" + 
"/*:data*/ \n" +
"/*:descricao \n" +
"/*:usd*/ \n" +
"/*"+ separator.repeat(maxLength) +"*/"

		// Data values
		var day = dataObj.getUTCDate() < 10 ? "0" + dataObj.getUTCDate() : dataObj.getUTCDate()
		var month = (dataObj.getUTCMonth() + 1) < 10 ? "0" + (dataObj.getUTCMonth() + 1) : (dataObj.getUTCMonth() + 1)
		var year = dataObj.getUTCFullYear()			
		var date = " Data      : " + day + '/' + month + '/' + year;		
		
		// Autor
		if (autor.length > maxLength) {
			base = base.replace(':autor', autor);
		} else {
			base = base.replace(':autor', autor + " ".repeat(maxLength - autor.length))
		}
		
		// Data
		base = base.replace(':data', date + " ".repeat(maxLength - date.length))
		
		// Descrição
		base = base.replace(':descricao', descricao)
		
		// USD
		if (usd.length > maxLength) {
			base = base.replace(':usd', usd)
		} else {
			base = base.replace(':usd', usd + " ".repeat(maxLength - usd.length))
		}
		
		document.getElementById('resultado').value = base
		console.log('Fuxicando no código dos outros!!! -_-')
		console.log('Toma ai seu comentário...')
		console.log(base)		
		return null
	}


	function SepararDescricao(descricao) {
            var linhas = descricao.split('\n')

            var novasLinhas = []

            linhas.map((plinha, index) => {
                var linha = plinha

                while (linha.length > maxDescription){                    
                    var limite = linha.substring(0, maxDescription)
                    var indexOfSpace = limite.lastIndexOf(" ")

                    if (indexOfSpace > 0) {
                        novasLinhas.push(linha.substring(0, indexOfSpace))
                        linha = linha.substring(indexOfSpace)
                    } else {
                        novasLinhas.push(linha.substring(0, maxDescription - 1))
                        linha = linha.substring(maxDescription - 1)
                    }
                }

                novasLinhas.push(linha)                
            })

			novasLinhas = novasLinhas.map((linha, index) => {				
				// Primeira linha
				if (index === 0) {
					linha = linha + " ".repeat(maxDescription - linha.length) + "*/"
					return linha
				} 

				// Outas linhas
				if (index > 0){
					linha = linha + " ".repeat(maxDescription - linha.length) + "*/"
					linha = "/*" + " ".repeat(lineStart) + linha
					return linha
				}

				return "/*" + " ".repeat(lineStart) + linha + " ".repeat(maxDescription - linha.length) + "*/"
			})
            
            return novasLinhas.join('\n')
        }
</script>
</html>
